{"version":3,"sources":["Recipe/index.js","Calculator.js","SharedRecipe.js","share/index.js","App.js","reportWebVitals.js","index.js"],"names":["removeComponent","currentState","action","removingComponent","recipe","components","find","recipeComponent","name","component","_","cloneDeep","error","message","filteredRecipeComponents","filter","updatedState","availableComponents","push","grams","unlockedComponents","locked","length","gramsPerComponent","Decimal","div","forEach","add","toString","setEvenGrams","reducer","type","swappedComponents","previous","availableComponent","current","swapComponent","recipeGrams","newGrams","reduce","otherComponent","deltaGrams","minus","componentsToUpdate","numberOfComponentsToUpdate","gramsPerComponentsToUpdate","componentToUpdate","sumOfGrams","a","b","anyNegative","some","startsWith","equals","updateComponentGrams","proportions","template","fixedComponents","fixedComponent","decimalProportion","toNumber","map","times","updateRecipeGrams","toggleLock","includes","addComponent","fixedComponentsDecimalProportion","fixedComponentsRecipe","firstOtherComponent","otherComponents","createNewRecipe","SelectComponent","selectedComponent","props","value","Calculator","onChangeRecipeGrams","onSwapComponent","onToggleComponent","onUpdateComponentGrams","style","textAlign","pattern","onChange","index","color","backgroundColor","disabled","ev","target","onClick","width","verticalAlign","sharedRecipe","className","stateToShareableURL","state","compressedState","hash","compressState","btoa","JSON","stringify","window","location","origin","process","App","React","useReducer","dispatch","encodedCompressedState","decodedState","parse","atob","componentArray","decompressState","substr","SharedRecipe","marginTop","cursor","marginRight","href","text","onCopy","alert","marginLeft","recipeTemplates","isDecimal","candidate","e","Error","test","url","recipeTemplate","defaultValue","isNeg","assign","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.77fe7e64.chunk.js","sourcesContent":["import Decimal from 'decimal.js';\nimport _ from \"lodash\";\n\n\n//const round = num => parseFloat(num.toPrecision(3));\nconst round = num => Decimal(num.toPrecision(3)).toNumber();\n\nconst createNewRecipe = (currentState, action) => {\n  const {template} = action;\n  const fixedComponentsDecimalProportion = template.fixedComponents.reduce((a,b) => a.add(Decimal(b.decimalProportion)), Decimal(0));\n  const fixedComponentsRecipe = template.fixedComponents.map(component => ({\n    name: component.name,\n    grams: component.decimalProportion.toString(),\n    locked: true,\n  }));\n  const firstOtherComponent = {\n    ...template.otherComponents[0],\n    grams: Decimal(1).minus(fixedComponentsDecimalProportion).toString(),\n    locked: false,\n  };\n  const availableComponents = template.otherComponents\n    .filter(component => component.name !== firstOtherComponent.name);\n  return {\n    recipe: {\n      name: template.name,\n      grams: \"1\",\n      components: [\n        ...fixedComponentsRecipe,\n        firstOtherComponent\n      ]\n    },\n    availableComponents,\n    template,\n  }\n};\n\nconst toggleLock = (currentState, action) => {\n  const updatedState = _.cloneDeep(currentState);\n  updatedState.recipe.components = updatedState.recipe.components.map(recipeComponent => recipeComponent.name !== action.component.name ? recipeComponent : {...recipeComponent, locked: !recipeComponent.locked});\n  return updatedState;\n};\n\nconst addComponent = (currentState, action) => {\n  const {component} = action;\n  const updatedState = _.cloneDeep(currentState);\n  if (updatedState.availableComponents.length === 0) {\n    return {\n      ...updatedState,\n      error: {\n        message: \"No es posible agregar más componentes a esta receta\"\n      }\n    };\n  }\n  const supportedComponentsNames = updatedState.availableComponents.map(otherComponent => otherComponent.name);\n  if (!supportedComponentsNames.includes(component.name)) {\n      return {\n        ...updatedState,\n        error: {\n          message: `Material no soportado: ${component.name}`\n      }\n    }\n  }\n  return {\n    recipe:{\n      ...updatedState.recipe,\n      components: [\n        ...updatedState.recipe.components,\n        {...component, grams: \"0\", locked: false}\n      ]\n    },\n    availableComponents: updatedState.availableComponents.filter(availableComponent => availableComponent.name !== component.name),\n    template: updatedState.template,\n  };\n};\n\nconst setEvenGrams = (components, grams = 0) => {\n  const unlockedComponents = components.filter(component => !component.locked);\n  if (unlockedComponents.length > 0) {\n    const gramsPerComponent = new Decimal(grams).div(unlockedComponents.length);\n    unlockedComponents.forEach(component => {\n      component.grams = new Decimal(component.grams).add(gramsPerComponent).toString();\n    });\n  }\n}\n\nconst removeComponent = (currentState, action) => {\n  const removingComponent = currentState.recipe.components.find(recipeComponent => recipeComponent.name === action.component.name);\n  if (currentState.recipe.components[0].name === action.component.name) {\n    return {\n      ..._.cloneDeep(currentState),\n      error: {\n        message: \"No es posible eliminar el componente principal\"\n      }\n    }\n  }\n  const filteredRecipeComponents = currentState.recipe.components.filter(recipeComponent => recipeComponent.name !== action.component.name);\n  const updatedState = _.cloneDeep(currentState);\n  \n  updatedState.recipe.components = filteredRecipeComponents;\n  updatedState.availableComponents.push({name: action.component.name})\n  setEvenGrams(updatedState.recipe.components, removingComponent.grams);\n  return updatedState;\n};\n\nconst updateRecipeGrams = (currentState, action) => {\n  const updatedState = _.cloneDeep(currentState);//{ ...currentState };\n  const recipeGrams = Decimal(updatedState.recipe.grams);\n  const proportions = {};\n  updatedState.template.fixedComponents.forEach(fixedComponent => {\n    proportions[fixedComponent.name] = fixedComponent.decimalProportion;\n  });\n  updatedState.recipe.components\n    .filter(recipeComponent => !(recipeComponent.name in proportions) )\n    .forEach(component => {\n    proportions[component.name] = Decimal(component.grams).div(recipeGrams).toNumber();\n  });\n\n  updatedState.recipe.grams = action.grams.toString();\n  updatedState.recipe.components = updatedState.recipe.components.map(component => ({\n    ...component,\n    grams: Decimal(updatedState.recipe.grams).times(Decimal(proportions[component.name])).toString()\n  }));\n  return updatedState;\n};\n\nconst updateComponentGrams = (currentState, action) => {\n  const updatedState = _.cloneDeep(currentState);//{...currentState};\n  const recipeGrams = Decimal(updatedState.recipe.grams);\n  const otherComponents = updatedState.recipe.components\n    .filter(recipeComponent => recipeComponent.name !== action.component.name);\n  const otherGrams = otherComponents.reduce((grams, otherComponent) => grams.add(Decimal(otherComponent.grams)), Decimal(0));\n  const newGrams = otherGrams.add(Decimal(action.component.grams));\n  const deltaGrams = recipeGrams.minus(newGrams);//round(recipeGrams - newGrams);\n  const componentsToUpdate = updatedState.recipe.components\n    .filter(recipeComponent => recipeComponent.name !== action.component.name && !recipeComponent.locked);\n  \n  const numberOfComponentsToUpdate = Decimal(componentsToUpdate.length);\n  const gramsPerComponentsToUpdate = deltaGrams.div(numberOfComponentsToUpdate);//round(Decimal(deltaGrams).div(Decimal(numberOfComponentsToUpdate)));\n  componentsToUpdate.forEach(componentToUpdate => {\n    componentToUpdate.grams = Decimal(componentToUpdate.grams).add(gramsPerComponentsToUpdate).toString();//round(componentToUpdate.grams + gramsPerComponentsToUpdate);\n  });\n  \n  const updatingComponent = updatedState.recipe.components.find(recipeComponent => recipeComponent.name === action.component.name);\n  updatingComponent.grams = action.component.grams.toString();\n\n  const sumOfGrams = updatedState.recipe.components.reduce((a, b) => a.add(Decimal(b.grams)), Decimal(0));\n  const anyNegative = updatedState.recipe.components.some(recipeComponent => recipeComponent.grams.startsWith(\"-\"));\n  if (!sumOfGrams.equals(updatedState.recipe.grams) || anyNegative) {\n    return currentState;\n  }\n  return updatedState;\n};\n\nconst swapComponent = (currentState, action) => {\n  const updatedState = _.cloneDeep(currentState);\n  const recipeComponent = updatedState.recipe.components.find(recipeComponent => recipeComponent.name === action.swappedComponents.previous);\n  const availableComponent = updatedState.availableComponents.find(availableComponent => availableComponent.name === action.swappedComponents.current);\n  \n  recipeComponent.name = action.swappedComponents.current;\n  availableComponent.name = action.swappedComponents.previous;\n  return updatedState;\n};\n\nexport const reducer = (currentState, action) => {\n    const type = action.type;\n    switch(type) {\n      case \"swapComponent\":\n        return swapComponent(currentState, action);\n      case \"updateComponentGrams\":\n        return updateComponentGrams(currentState, action);\n      case \"updateRecipeGrams\":\n        return updateRecipeGrams(currentState, action);\n      case \"removeComponent\":\n        return removeComponent(currentState, action); \n      case \"toggleLock\":\n        return toggleLock(currentState, action);\n      case \"addComponent\":\n        return addComponent(currentState, action);\n\n      case \"new\":\n        return createNewRecipe(currentState, action);\n      default:\n\n    }\n    return currentState;\n};\n","import React from 'react';\n//import { FcLock as Locked, FcUnlock as Unlocked } from \"react-icons/fc\";\nimport { FaLock as Locked, FaUnlock as Unlocked } from \"react-icons/fa\";\n\n\nconst SelectComponent = ({components = [], selectedComponent = {}, ...props}) => {\n  return (\n    <select value={selectedComponent.name} {...props}>\n      {components.map(component => (\n        <option key={component.name} value={component.name}>{component.name}</option>\n      ))}\n    </select>\n  );\n};\n\nconst Calculator = ({\n  recipe = {}, \n  components=[],\n  onChangeRecipeGrams = () => {},\n  onSwapComponent = () => {},\n  onToggleComponent = () => {},\n  onUpdateComponentGrams = () => {},\n}) => {\n  if (!recipe.name) {\n    return null;\n  }\n\n  return (\n    <div style={{textAlign: \"left\"}}>\n      <h3>Gramaje deseado</h3>\n      {recipe.name} <input type=\"text\" pattern=\"[0-9|\\.]\" onChange={onChangeRecipeGrams} value={recipe.grams}/> <br />\n      <h3>Receta</h3>\n      {recipe.components.map((component, index) => (\n        <div key={component.name}>\n           <SelectComponent style={index === 0 ? {color: \"gray\", backgroundColor: \"white\"} : {}}\n              disabled={index === 0} components={[component, ...components]} selectedComponent={component} onChange={ev => {\n                if(component.name !== ev.target.value) {\n                  onSwapComponent(component.name, ev.target.value);\n                }\n              }}/>  <input type=\"number\" value={component.grams} onChange={ev => onUpdateComponentGrams(component.name, ev.target.value)}/> {(component.locked && <Locked onClick={() => onToggleComponent(component.name)} style={{width:15, verticalAlign: \"middle\"}}/>) || <Unlocked onClick={() => onToggleComponent(component.name)} style={{width:15, verticalAlign: \"middle\"}}/>}\n        </div>\n      ))}\n    </div>\n  );\n};\n\nexport default Calculator;\n","import React from 'react';\n\n\nexport default ({sharedRecipe}) => {\n  return (\n    <>\n      <h4>{sharedRecipe.recipe.name}: {sharedRecipe.recipe.grams} gr</h4>\n      <div className=\"recipe\">\n        {sharedRecipe.recipe.components.map(recipeComponent => (\n          <div key={recipeComponent.name}>{recipeComponent.name} = {recipeComponent.grams} gr</div>\n        ))}\n      </div>\n    </>\n  );\n};\n","import Decimal from 'decimal.js';\n\nexport const compressState = state => {\n  return [\n    state.recipe.name,\n    Decimal(state.recipe.grams).toNumber(),\n    state.recipe.components.map(recipeComponent => [\n      recipeComponent.name, Decimal(recipeComponent.grams).toNumber()\n    ])\n  ]\n};\n\nexport const encodeCompressedState = compressedState => {\n  return btoa(JSON.stringify(compressedState));\n};\n\nexport const stateToShareableURL = state => {\n  const hash = encodeCompressedState(compressState(state))\n  return `${window.location.origin}${process.env.PUBLIC_URL}?t=0#${hash}`;\n};\n\nexport const decompressState = encodedCompressedState => {\n  const decodedState= JSON.parse(atob(encodedCompressedState));\n  return {\n    recipe: {\n      name: decodedState[0],\n      grams: decodedState[1],\n      components: decodedState[2].map(componentArray => ({\n        name: componentArray[0],\n        grams: componentArray[1]\n      }))\n    }\n  };\n};\n","import React from 'react';\nimport './App.css';\nimport {reducer} from './Recipe';\nimport Calculator from './Calculator.js';\nimport Decimal from 'decimal.js';\nimport SharedRecipe from './SharedRecipe';\nimport {decompressState, stateToShareableURL} from './share';\nimport {FaRegShareSquare as ShareIcon } from \"react-icons/fa\";\nimport {GrCalculator as CalculatorIcon } from \"react-icons/gr\";\nimport {FiHome as Home, FiCopy as CopyIcon } from \"react-icons/fi\";\nimport {CopyToClipboard} from 'react-copy-to-clipboard';\n\n/*\nconst RecipeCalculator = (props) => {\n  return (\n    <>\n        <h5>Aleaciones</h5>\n        <select onChange={onSelectRecipe} defaultValue=\"\">\n          <option>-- Escoge aleación --</option>\n          {recipeTemplates.map((recipe, index) => (\n            <option key={recipe.name} value={index}>{recipe.name}</option>\n          ))}\n        </select>\n        <Calculator\n          components={state?.availableComponents ?? []} recipe={state.recipe}\n          onChangeRecipeGrams={onChangeRecipeGrams}\n          onSwapComponent={onSwapComponent}\n          onToggleComponent={onToggleComponent}\n          onUpdateComponentGrams={onUpdateComponentGrams}/>\n        <br />\n        {state.availableComponents && (\n          <>\n            <select onChange={addComponent} value=\"\">\n              <option value=\"\">-- Agregar Componente --</option>\n              {state.availableComponents.map(availableComponent => (\n                  <option key={availableComponent.name} value={availableComponent.name}>{availableComponent.name}</option>\n              ))}\n            </select>\n            <br />\n          </>\n        )}\n    </>);\n};\n*/\n\nfunction App() {\n\n  const [state, dispatch] = React.useReducer(reducer, {});\n  const getShareURL = () => {\n    return stateToShareableURL(state);\n  }; \n\n  if(window.location.hash.length > 1) {\n    const sharedRecipe = decompressState(window.location.hash.substr(1));\n    return (\n      <div className=\"App\">\n        <header className=\"App-header\">\n          <h3>Calculadora Joyería</h3>\n          <SharedRecipe sharedRecipe={sharedRecipe}/>\n          <div style={{marginTop: 50}}>\n            <Home style={{color: \"white\", cursor: \"pointer\", marginRight: 25}} onClick={() => window.location.href = `${window.location.origin}${process.env.PUBLIC_URL}`}/>\n            <CopyToClipboard text={window.location.href} onCopy={() => alert(\"Copiado!\")}>\n              <CopyIcon style={{marginLeft: 25, color: \"yellow\", cursor: \"pointer\"}} />\n            </CopyToClipboard>\n          </div>\n        </header>\n      </div>\n    );\n  }\n\n\n  \n  const recipeTemplates = [\n    {\n      name: \"Plata 925\",\n      fixedComponents: [\n        {\"name\": \"Plata\", \"decimalProportion\": 0.925}\n      ],\n      otherComponents: [\n        {\"name\": \"Cobre\"},\n        {\"name\": \"Aloi\"},\n        {\"name\": \"Pandora\"},\n      ]\n    },\n    {\n      name: \"Oro 18k\",\n      fixedComponents: [\n        {\"name\": \"Oro\", \"decimalProportion\": 0.75}\n      ],\n      otherComponents: [\n        {\"name\": \"Plata\"},\n        {\"name\": \"Paladio\"},\n        {\"name\": \"Platino\"},\n      ]\n    }\n  ];\n\n  const onSelectRecipe = ev => {\n    const recipeTemplate = recipeTemplates[ev.target.value];\n    dispatch({type: \"new\", template: recipeTemplate});\n  };\n\n  const isDecimal = candidate => {\n    try {\n      Decimal(candidate);\n    } catch (e) {\n      if ( e instanceof Error && /DecimalError/.test(e.message) ) {\n        return false\n      }\n    }\n    return true;\n  };\n\n  const onChangeRecipeGrams = ev => {\n    /*\n    let textValue = ev.target.value;\n    if (textValue.indexOf(\".\") === textValue.lastIndexOf(\".\") && textValue.endsWith(\".\")) {\n      textValue += \"0\"\n    }\n    let recipeGrams = parseFloat(textValue);\n    if (isNaN(recipeGrams) || recipeGrams === 0.0) {\n      recipeGrams = 1;\n    }*/\n    const recipeGrams = ev.target.value !== \"\" ? ev.target.value : \"0\";\n    if (isDecimal(recipeGrams) && !Decimal(recipeGrams).isNeg()) { //TODO: can we do this more efficiently?\n      dispatch({type: \"updateRecipeGrams\", grams: recipeGrams});\n    }\n  };\n\n  const onSwapComponent = (previous, current) => {\n    dispatch({type: \"swapComponent\", swappedComponents:{previous, current}});\n  };\n\n  const addComponent = ev => {\n    dispatch({type: \"addComponent\", component: {name: ev.target.value}});\n  };\n\n  const onToggleComponent = name => {\n    dispatch({type: \"toggleLock\", component: {name}});\n  };\n\n  const onUpdateComponentGrams = (name, grams) => {\n    if (isDecimal(grams)) { //TODO: can we do this more efficiently?\n      dispatch({type: \"updateComponentGrams\", component:{name, grams}});\n    }\n  };\n  const url = state.recipe ? getShareURL() : \"\";\n  return (\n    <div className=\"App\">\n      <header className=\"App-header\">\n        <h3>Calculadora Joyería</h3>\n        <h5>Aleaciones</h5>\n        <select onChange={onSelectRecipe} defaultValue=\"\">\n          <option>-- Escoge aleación --</option>\n          {recipeTemplates.map((recipe, index) => (\n            <option key={recipe.name} value={index}>{recipe.name}</option>\n          ))}\n        </select>\n        <Calculator\n          components={state?.availableComponents ?? []} recipe={state.recipe}\n          onChangeRecipeGrams={onChangeRecipeGrams}\n          onSwapComponent={onSwapComponent}\n          onToggleComponent={onToggleComponent}\n          onUpdateComponentGrams={onUpdateComponentGrams}/>\n        <br />\n        {state.availableComponents && (\n          <>\n            <select onChange={addComponent} value=\"\">\n              <option value=\"\">-- Agregar Componente --</option>\n              {state.availableComponents.map(availableComponent => (\n                  <option key={availableComponent.name} value={availableComponent.name}>{availableComponent.name}</option>\n              ))}\n            </select>\n            <br />\n          </>\n        )}\n        {state.recipe && <div>\n          <ShareIcon onClick={() => window.location.assign(url)} style={{cursor: \"pointer\"}} />\n        </div>}\n      </header>\n    </div>\n  );\n}\n\nexport default App;\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}